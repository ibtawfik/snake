angular.module("myApp",[]).controller("Ctrl",["$translate","$scope","$log","resizeGameAreaService","realTimeService",function(a,b,c,d,e){"use strict";function f(a){G=a.yourPlayerIndex,F=a.playersInfo,Math.seedrandom(a.matchId),D=!0,E=1===F.length,z=0,w=[],y=[];for(var b=0;b<F.length;b++)w[b]=m(b),y[b]=0;x=w[G],n(),A="right",C=(new Date).getTime(),k()}function g(a){var b=a.fromPlayerIndex,c=a.message,d=angular.fromJson(c);for(w[b]=d.a,y[b]=d.s;z<d.f;)n()}function h(a){y=a,D=!1,l()}function i(a){if(!E&&D){var b=angular.toJson({f:z,s:y[G],a:x});a?e.sendReliableMessage(b):e.sendUnreliableMessage(b)}}function j(){D&&(D=!1,e.endMatch(y))}function k(){l();var a=Math.max(30,N-10*Math.floor(z/3));H=setInterval(o,a)}function l(){clearInterval(H)}function m(a){for(var b=5,c=[],d=b-1;d>=0;d--)c.push({x:d,y:a-Math.floor(F.length/2)+K/M/2});return c}function n(){B={x:Math.round(Math.random()*(K-M)/M),y:Math.round(Math.random()*(L-M)/M)},z++}function o(){if(D){var b=Math.floor(((new Date).getTime()-C)/1e3);if(3>b){P=[],p();var c=3-b,d=O[G];J.fillStyle=d,J.font="80px sans-serif",J.fillText(""+c,K/2,L/2),J.font="20px sans-serif";var e=a.instant("YOUR_SNAKE_COLOR_IS",{color:a.instant(d.toUpperCase())});return void J.fillText(e,K/4-30,L/4-30)}t();var f=x[0].x,g=x[0].y;if("right"===A?f++:"left"===A?f--:"up"===A?g--:"down"===A&&g++,-1===f||f===K/M||-1===g||g===L/M||s(f,g,x))return void j();var h,k=!0;f===B.x&&g===B.y?(k=!1,h={x:f,y:g},y[G]++,n()):(h=x.pop(),h.x=f,h.y=g),x.unshift(h),i(k),p()}}function p(){J.fillStyle="white",J.fillRect(0,0,K,L),J.strokeStyle="black",J.strokeRect(0,0,K,L);var b;for(b=0;b<w.length;b++)b!==G&&q(w[b],b);for(q(x,G),r(B.x,B.y,"green"),b=0;b<y.length;b++){J.font="12px sans-serif";var c=O[b];J.fillStyle=c;var d=a.instant("COLOR_SCORE_IS",{color:a.instant(c.toUpperCase()),score:""+y[b]});J.fillText(d,5+b*K/F.length,L-5)}}function q(a,b){for(var c=0;c<a.length;c++){var d=a[c];r(d.x,d.y,O[b])}}function r(a,b,c){J.fillStyle=c,J.fillRect(a*M,b*M,M,M),J.strokeStyle="white",J.strokeRect(a*M,b*M,M,M)}function s(a,b,c){for(var d=0;d<c.length;d++)if(c[d].x===a&&c[d].y===b)return!0;return!1}function t(){var a=P.shift();a&&("left"===a&&"right"!==A?A="left":"up"===a&&"down"!==A?A="up":"right"===a&&"left"!==A?A="right":"down"===a&&"up"!==A&&(A="down"))}function u(a){P.length>0&&P[P.length-1]===a||P.push(a)}function v(a){a.preventDefault();var b=a.changedTouches[0],c=b.pageX-Q,d=b.pageY-R,e=null,f=Math.abs(c),g=Math.abs(d);(f>=20||g>=20)&&(Q=b.pageX,R=b.pageY,e=f>g?0>c?"left":"right":0>d?"up":"down",u(e))}d.setWidthToHeight(1);var w,x,y,z,A,B,C,D=!1,E=!1,F=null,G=null;e.setGame({gotStartMatch:f,gotMessage:g,gotEndMatch:h});var H,I=document.getElementById("canvas"),J=I.getContext("2d"),K=300,L=300,M=10,N=100,O=["blue","red","brown","purple","pink","purple","orange","silver","yellow","cyan"],P=[];document.addEventListener("keydown",function(a){var b=a.which,c=37===b?"left":38===b?"up":39===b?"right":40===b?"down":null;null!==c&&u(c)},!1);var Q=null,R=null;I.addEventListener("touchstart",function(a){var b=a.changedTouches[0];Q=b.pageX,R=b.pageY,a.preventDefault()},!1),I.addEventListener("touchmove",function(a){v(a)},!1),I.addEventListener("touchend",function(a){v(a)},!1)}]);
//# sourceMappingURL=index.min.js.map